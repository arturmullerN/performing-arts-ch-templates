<ol class="page-breadcrumb">
  <li>
    <mp-link title="Home" url="/">Home</mp-link>
  </li>
  <li class="active">
    [[> sapaModule:RecordLabel ]]
  </li>
</ol>

<div class="page">
    [[> sapaModule:RecordNavTabHeader defaultImage="../images/fcs/actors.svg"]]
    <bs-tabs id='record-tabs' class='page__body-navtabs' default-active-key='Summary' unmount-on-exit=true>
      <bs-tab event-key='Summary' title='Summary'>
        <bs-col sm="4">
            <!-- official name -->
            <semantic-query 
                query='SELECT ?typelabel ?value
                WHERE {
                    ?? crm:P1_is_identified_by ?app .
                    ?app a crm:E41_Appellation ; 
                    crm:P2_has_type spav:yanuj ;
                    rdf:value ?value .
                } LIMIT 1'
            template='<p><strong>{{#each bindings}}{{value.value}}{{/each}}</strong></p>'>
            </semantic-query>

            <!-- alternative names -->
            <semantic-query 
                query='SELECT distinct ?value ?type ?typesort
                WHERE {
                    VALUES (?type ?typesort) { (spav:yamqk 1) (spav:yavtx 2) }
                    ?? crm:P1_is_identified_by ?appellation .
                    ?appellation a crm:E41_Appellation ; 
                    crm:P2_has_type ?type ;
                    rdf:value ?value .
                    { ?appellation crm:P2_has_type spav:yamqk . }
                    UNION
                    { ?appellation crm:P2_has_type spav:yavtx . }
                } ORDER BY ?typesort'
                template='<p>({{#each bindings}}{{#if @first}}{{value.value}}{{else}}, {{value.value}}{{/if}}{{/each}})</p>'>
            </semantic-query>

            <!-- pseudonym -->
            <semantic-query 
                query='SELECT ?value
                WHERE {
                    ?? crm:P1_is_identified_by ?appellation .
                    ?appellation a crm:E41_Appellation ; 
                        crm:P2_has_type spav:yaajh ;
                        rdf:value ?value .
                }'
                template='<p>AKA {{#each bindings}}{{#if @first}}{{value.value}}{{else}}, {{value.value}}{{/if}}{{/each}}</p>'>
            </semantic-query>

            <!-- Swiss -->
            <semantic-query 
                query='SELECT ?swiss ?value WHERE {
                    BIND (EXISTS {?? ore:isAggregatedBy <http://data.performing-arts.ch/a/2ced7bbf-4981-48e0-ab47-2c6b1351c38b>} AS ?swiss)
                    BIND(IF(?swiss ,"CH","") AS ?value)
                }'
                template='<p>{{#each bindings}}{{value.value}}{{/each}}</p>'>
            </semantic-query>

            <!-- Live dates -->
            <semantic-query 
                query='SELECT ?wikidata ?birthyear ?birthplacelabel ?deathyear ?deathplacelabel
    WHERE {
        ?? owl:sameAs ?wikidata .
        FILTER (CONTAINS(STR(?wikidata), "wikidata"))
        SERVICE <https://wikidata.metaphacts.com/sparql> {
            OPTIONAL {
                ?wikidata <http://www.wikidata.org/prop/direct/P569> ?birthdate .
                BIND(YEAR(?birthdate) AS ?birthyear)
            }
            OPTIONAL {
                ?wikidata <http://www.wikidata.org/prop/direct/P570> ?deathdate .
                BIND(YEAR(?deathdate) AS ?deathyear)
            }
            OPTIONAL {
                ?wikidata <http://www.wikidata.org/prop/direct/P19> ?birthplace .
                ?birthplace rdfs:label ?birthplacelabel .
            }
            OPTIONAL {
                ?wikidata <http://www.wikidata.org/prop/direct/P20> ?deathplace .
                ?deathplace rdfs:label ?deathplacelabel .
            }
        }
    }'
                template='{{#each bindings}}<p>{{birthyear.value}}-{{deathyear.value}}</p>{{/each}}'>
            </semantic-query>


        </bs-col>
        <bs-col sm="4">
            <mp-field-visualization
            subject='[[this]]'
            fields='[[fieldDefinitions    
              http://performing-arts.ch/ldp-assets/fieldDefinitionContainer/E21_Person_is_current_or_former_member_of="http://performing-arts.ch/ldp-assets/fieldDefinitionContainer/E21_Person_is_current_or_former_member_of"
            ]]'
            template='{{> sapaModule:FieldBasedVisualizationList subject="[[this]]"}}' [[!-- show in include [[> sapaModule:FieldBasedVisualizationList ]] --]]
            ></mp-field-visualization> 
        </bs-col>
        <bs-col sm="4">
            [[> sapa:ExternalResources]]
        </bs-col>
      </bs-tab>
    </bs-tabs>  
</div>